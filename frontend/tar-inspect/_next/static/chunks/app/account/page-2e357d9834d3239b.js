(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[298],{63:(e,t,r)=>{"use strict";var n=r(7260);r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}}),r.o(n,"useSearchParams")&&r.d(t,{useSearchParams:function(){return n.useSearchParams}})},3629:(e,t,r)=>{Promise.resolve().then(r.bind(r,7035))},7035:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>y});var n=r(5155),o=r(2115),a=r(63),i=r(6993);async function c(e){let t=await new Promise((e,t)=>{let r=indexedDB.open("woco-auth",1);r.onupgradeneeded=()=>{r.result.objectStoreNames.contains("kv")||r.result.createObjectStore("kv")},r.onsuccess=()=>e(r.result),r.onerror=()=>{var e;return t(null!=(e=r.error)?e:Error("IndexedDB open error"))}});return await new Promise((r,n)=>{let o=t.transaction("kv","readonly").objectStore("kv").get(e);o.onsuccess=()=>r(o.result),o.onerror=()=>{var e;return n(null!=(e=o.error)?e:Error("IDB get error"))}})}function l(e){let t=e.startsWith("0x")?e.slice(2):e,r=new Uint8Array(t.length/2);for(let e=0;e<r.length;e++)r[e]=parseInt(t.slice(2*e,2*e+2),16);return r}function s(e){let t=new ArrayBuffer(e.byteLength);return new Uint8Array(t).set(e),t}async function d(e,t){let r=l(t.iv),n=l(t.ct),o=await crypto.subtle.decrypt({name:"AES-GCM",iv:s(r)},e,s(n));return JSON.parse(new TextDecoder().decode(o))}function u(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"text/plain",n=new Blob([t],{type:r}),o=URL.createObjectURL(n),a=document.createElement("a");a.href=o,a.download=e,document.body.appendChild(a),a.click(),a.remove(),URL.revokeObjectURL(o)}function y(){let e=(0,a.useRouter)(),[t,r]=(0,o.useState)("none"),[l,s]=(0,o.useState)(null),[y,h]=(0,o.useState)(null);(0,o.useEffect)(()=>{let e=!0;return(async()=>{try{let t=await c("woco:kind");if(!e)return;if(r(null!=t?t:"none"),"local"!==t)return void s(null);let n=await c("woco:deviceKey"),o=await c("woco:encKeystore");if(!n||!o)return void s(null);let{keystore:a}=await d(n,o),l=await i.u.fromEncryptedJson(a,"dummy-pass");if(!e)return;s(l.privateKey)}catch(t){if(!e)return;h(String(t)),s(null)}})(),()=>{e=!1}},[]);let p=(0,o.useMemo)(()=>{try{return l?new i.u(l).address:void 0}catch(e){return}},[l]);async function f(){if(l)try{await navigator.clipboard.writeText(l),alert("Private key copied. Handle with care.")}catch(e){alert("Could not copy to clipboard.")}}async function w(){if(!l||!p)return;let e=prompt("Enter a password for the keystore JSON (do not forget it):");if(e)try{let t=await new i.u(l).encrypt(e);u(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Date,r=e=>String(e).padStart(2,"0"),n="".concat(t.getUTCFullYear(),"-").concat(r(t.getUTCMonth()+1),"-").concat(r(t.getUTCDate()),"T").concat(r(t.getUTCHours()),"-").concat(r(t.getUTCMinutes()),"-").concat(r(t.getUTCSeconds()),".000Z");return"UTC--".concat(n,"--").concat(e.slice(2).toLowerCase(),".json")}(p),t,"application/json")}catch(e){alert("Failed to create keystore: ".concat(String(e)))}}return(0,n.jsxs)("main",{style:{maxWidth:680,margin:"24px auto",padding:16},children:[(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:12},children:[(0,n.jsx)("button",{onClick:()=>e.push("/dashboard"),style:{fontSize:14,color:"#4b5563",textDecoration:"underline",background:"none",border:"none",cursor:"pointer"},children:"Back to Dashboard"}),(0,n.jsx)("h1",{style:{fontSize:18,fontWeight:600,margin:0},children:"Export Private Key"})]}),y&&(0,n.jsx)("p",{style:{color:"#b91c1c",fontSize:12,marginBottom:12},children:y}),"local"===t&&l&&p?(0,n.jsxs)("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:16},children:[(0,n.jsxs)("div",{style:{fontSize:13,marginBottom:8},children:["Mode: ",(0,n.jsx)("b",{children:"Local account"})]}),(0,n.jsxs)("div",{style:{fontSize:12,wordBreak:"break-all",marginBottom:8},children:["Address: ",(0,n.jsx)("code",{children:p})]}),(0,n.jsxs)("div",{style:{fontSize:12,marginBottom:12},children:["Private key (masked): ",(0,n.jsxs)("code",{children:["0x****",l.slice(-6)]})]}),(0,n.jsxs)("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[(0,n.jsx)("button",{onClick:f,children:"Copy private key"}),(0,n.jsx)("button",{onClick:function(){l&&p&&u("account-".concat(p.slice(2,10),".txt"),"# WARNING: PRIVATE KEY (UNENCRYPTED)\n# Anyone with this key can control your funds/identity.\nAddress: ".concat(p,"\nPrivateKey: ").concat(l,"\n"),"text/plain")},children:"Download PK (.txt)"}),(0,n.jsx)("button",{onClick:w,children:"Download keystore (JSON)"})]}),(0,n.jsxs)("p",{style:{fontSize:11,color:"#92400e",marginTop:10},children:[(0,n.jsx)("b",{children:"Security warning:"})," Anyone with your private key (or keystore + password) can control this account. Store offline and never share."]})]}):(0,n.jsxs)("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:16,fontSize:13},children:["Mode: ",(0,n.jsx)("b",{children:"web3"===t?"Web3 wallet":"No local key"}),(0,n.jsx)("p",{style:{marginTop:8,color:"#4b5563",fontSize:12},children:"Private key export is only available for local accounts created on first login. Since we didn’t detect a local account, there’s nothing to export."})]})]})}}},e=>{e.O(0,[993,441,493,358],()=>e(e.s=3629)),_N_E=e.O()}]);