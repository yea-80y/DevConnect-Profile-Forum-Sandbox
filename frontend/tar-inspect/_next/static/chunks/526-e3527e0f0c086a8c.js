(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[526],{43:(e,t,r)=>{"use strict";r.d(t,{H:()=>v,x:()=>d});var n=r(5155),l=r(2115),a=r(6149),u=r(5373),i=r(73);function o(e){let t=0x811c9dc5;for(let r=0;r<e.length;r++)t^=e[r],t=t+(t<<1>>>0)+(t<<4>>>0)+(t<<7>>>0)+(t<<8>>>0)+(t<<24>>>0)>>>0;return t.toString(16).padStart(8,"0")}function f(e){if(!e)return null;try{let t=JSON.parse(e);return t&&"object"==typeof t?t:null}catch(e){return null}}async function c(e){let{beeUrl:t,feedOwner:r,subject:n,prev:l}=e,c=new a.VL(t),s=n.slice(2).toLowerCase(),d=a.KK.fromString("".concat(u.l4,"/name/").concat(s)),v=a.KK.fromString("".concat(u.l4,"/avatar/").concat(s)),y={beeUrl:t,subject:n,feedOwner:r,name:null==l?void 0:l.name,avatarRef:null==l?void 0:l.avatarRef,nameMarker:null==l?void 0:l.nameMarker,avatarMarker:null==l?void 0:l.avatarMarker};try{let e=(await c.makeFeedReader(d,r).downloadPayload()).payload.toUtf8(),t=o(new TextEncoder().encode(null!=e?e:""));if(t!==(null==l?void 0:l.nameMarker)){let r=f(e);y.name=r&&"string"==typeof r.name?r.name:e&&"string"==typeof e?e:void 0,y.nameMarker=t}}catch(e){}try{let e=(await c.makeFeedReader(v,r).downloadPayload()).payload.toUtf8(),t=o(new TextEncoder().encode(null!=e?e:""));if(t!==(null==l?void 0:l.avatarMarker)){let r=f(e),n=(0,i.cX)(null!=r?r:e);y.avatarRef=null!=n?n:null==l?void 0:l.avatarRef,y.avatarMarker=t}}catch(e){}return y.name!==(null==l?void 0:l.name)||y.avatarRef!==(null==l?void 0:l.avatarRef)||y.nameMarker!==(null==l?void 0:l.nameMarker)||y.avatarMarker!==(null==l?void 0:l.avatarMarker)||y.beeUrl!==(null==l?void 0:l.beeUrl)?y:l}let s=(0,l.createContext)(null);function d(){let e=(0,l.useContext)(s);if(!e)throw Error("useProfile must be used within <ProfileProvider>");return e}function v(e){let{children:t,subject:r,feedOwner:a,beeUrl:u}=e,[i,o]=(0,l.useState)(null),f=(0,l.useMemo)(()=>r&&a?"profile:".concat(a,":").concat(r):null,[r,a]);(0,l.useEffect)(()=>{if(!f)return void o(null);try{let e=localStorage.getItem(f);if(!e)return void o(null);let t=JSON.parse(e);(null==t?void 0:t.subject)===r&&(null==t?void 0:t.feedOwner)===a?o(t):o(null)}catch(e){o(null)}},[f,r,a]),(0,l.useEffect)(()=>{if(f&&i)try{localStorage.setItem(f,JSON.stringify(i))}catch(e){}},[f,i]);let d=(0,l.useRef)(!1),v=(0,l.useRef)(0),y=(0,l.useCallback)(async()=>{if(r&&a&&!d.current){d.current=!0;try{let e=await c({beeUrl:u,feedOwner:a,subject:r,prev:i});e&&e!==i&&o(e),v.current=Date.now()}finally{d.current=!1}}},[u,a,r,i]);(0,l.useEffect)(()=>{let e=!1;return(async()=>{if(r&&a&&(await y(),e))return})(),()=>{e=!0}},[r,a,y]),(0,l.useEffect)(()=>{if(!r||!a)return;let e=async()=>{"visible"===document.visibilityState&&(Date.now()-v.current<12e4||await y())};return document.addEventListener("visibilitychange",e),()=>document.removeEventListener("visibilitychange",e)},[r,a,y]);let p=(0,l.useCallback)(e=>{o(t=>({...null!=t?t:{beeUrl:u,subject:r,feedOwner:a},...e}))},[u,r,a]),m=(0,l.useRef)({subject:null,feedOwner:null});(0,l.useEffect)(()=>{let e=m.current;(e.subject!==r||e.feedOwner!==a)&&null!==e.subject&&(o(null),y()),m.current={subject:r,feedOwner:a}},[r,a,y]);let b=(0,l.useMemo)(()=>({profile:i,ensureFresh:y,applyLocalUpdate:p}),[i,y,p]);return(0,n.jsx)(s.Provider,{value:b,children:t})}},73:(e,t,r)=>{"use strict";r.d(t,{F1:()=>c,FQ:()=>p,YT:()=>a,cX:()=>f,yU:()=>y});var n=r(6329);function l(e){return!!e&&"object"==typeof e}function a(e){if(!e)return null;let t=e.toLowerCase().replace(/^0x/,"");return t&&/^[0-9a-fA-F]{64}$/.test(t)?t:null}function u(e){return!!e&&/^0x[0-9a-fA-F]{40}$/.test(e)}function i(e){let t=e.toLowerCase().match(/([0-9a-f]{64})/);return t?t[1]:null}function o(e){let t=function e(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if("string"==typeof t){let e=r.join(".").toLowerCase(),l=a(t),u=null!=l?l:i(t);if(u){let t=0;e.includes("avatarref")&&(t+=200),(e.endsWith(".avatar.ref")||e.includes(".avatar.ref"))&&(t+=180),e.includes("avatar")&&(t+=150),e.includes("profile")&&(t+=25),(e.includes("current")||e.includes("latest"))&&(t+=15),e.endsWith(".ref")&&(t+=2),l||(t-=5),n.push({ref:u,score:t,path:r.join(".")})}return n}if(Array.isArray(t)){for(let l=0;l<t.length;l++)e(t[l],[...r,String(l)],n);return n}if(l(t))for(let[l,a]of Object.entries(t))e(a,[...r,l],n);return n}(e);return t.length?(t.sort((e,t)=>{if(t.score!==e.score)return t.score-e.score;let r=Number(e.path.toLowerCase().includes("avatar"));return Number(t.path.toLowerCase().includes("avatar"))-r}),t[0].ref):null}function f(e){if(l(e)){let t=a(e.avatarRef);if(t)return t;let r=e.avatar;if(l(r)){let e=a(r.ref);if(e)return e;let t=r.src;if("string"==typeof t){let e=i(t);if(e)return e}let n=r.url;if("string"==typeof n){let e=i(n);if(e)return e}}let n=e.profile;if(l(n)){let e=a(n.avatarRef);if(e)return e;let t=n.avatar;if(l(t)){let e=a(t.ref);if(e)return e;let r=t.src;if("string"==typeof r){let e=i(r);if(e)return e}let n=t.url;if("string"==typeof n){let e=i(n);if(e)return e}}let r=n.avatarSrc;if("string"==typeof r){let e=i(r);if(e)return e}let u=n.avatarUrl;if("string"==typeof u){let e=i(u);if(e)return e}}let u=e.avatarSrc;if("string"==typeof u){let e=i(u);if(e)return e}let o=e.avatarUrl;if("string"==typeof o){let e=i(o);if(e)return e}}return o(e)}function c(e){return o(e)}async function s(e){try{let t=null==e?void 0:e.trim().toLowerCase();if(!u(t))return null;for(let e of["owner","subject","address","addr","wallet","id"]){let r=(0,n.apiUrl)("/api/profile?".concat(e,"=").concat(encodeURIComponent(t)));try{let e=await fetch(r,{cache:"no-store"});if(!e.ok)continue;let t=await e.json(),n=o(t);if(n)return n}catch(e){}}return null}catch(e){return null}}let d=new Map,v=new Map;function y(e){let t=null==e?void 0:e.toLowerCase();if(!u(t))return Promise.resolve(null);if(d.has(t))return Promise.resolve(d.get(t));let r=v.get(t);if(r)return r;let n=s(t).then(e=>(d.set(t,null!=e?e:null),v.delete(t),null!=e?e:null)).catch(()=>(v.delete(t),null));return v.set(t,n),n}function p(e){e.forEach(e=>{y(e)})}},3998:(e,t,r)=>{"use strict";r.d(t,{$:()=>l});var n=r(5155);let l=r(2115).forwardRef((e,t)=>{let{className:r,variant:l="default",type:a,...u}=e,i=["inline-flex items-center justify-center rounded-lg px-4 py-2 text-sm font-medium disabled:opacity-50","secondary"===l?"border bg-white hover:bg-gray-50 text-black":"bg-black text-white hover:bg-black/90",r].filter(Boolean).join(" ");return(0,n.jsx)("button",{ref:t,type:null!=a?a:"button",className:i,...u})});l.displayName="Button"},5373:(e,t,r)=>{"use strict";r.d(t,{l4:()=>n}),r(6149);let n="devconnect/profile"},6197:()=>{},8701:(e,t,r)=>{"use strict";r.d(t,{b:()=>n,r:()=>l});let n="https://gateway.woco-net.com",l="58a35141d74fedb10a6d4ebb9064b3f473ecd98df49be771cc6abed98a0ee756"}}]);